# munin-server

Multi architecture container image for [Munin](http://munin-monitoring.org/) server using official Alpine image.

* `rrdcached` is used to be able to handle a large number of hosts

* `fcgi` is used for generation of graphs on demand and not cron

Inspired from build-failures [docker-munin-server](https://github.com/build-failure/docker-munin-server).
Forked from [aheimsbakk/munin](https://github.com/aheimsbakk/munin)

[![Docker Pulls](https://img.shields.io/docker/pulls/kdcio/munin-server)](https://hub.docker.com/r/kdcio/munin-server) [![GitHub Workflow Status](https://img.shields.io/github/workflow/status/kdcio/munin-server/Docker%20Build)](https://github.com/kdcio/munin-server/actions?query=workflow%3A%22Docker+Build%22) [![Docker Image Size (tag)](https://img.shields.io/docker/image-size/kdcio/munin-server/latest)](https://hub.docker.com/r/kdcio/munin-server)


## Tags

* latest ([Dockerfile](https://github.com/kdcio/munin-server/blob/master/Dockerfile))

## Environment variables

* `NODES`

    Format `[group1;]node1:ip1[:port1] [group2;]node2:ip2[:port2]...`

* `SNMP_NODES`

    Format `[group1;]node1:commutiy1: [group2;]node2:community2:...`

    Check SNMP units directly from the container. Defaults to SNMP version 2c.

* `TZ`

    Time zone. Defaults to `UTC`.

## Exposed ports

* `80`

## Volumes

For persistense.

* `/etc/munin/munin-conf.d/`

    Configuration files included on runtime. The files `nodes.conf` and `smtp-nodes.conf` are generated by this container.

* `/etc/munin/plugin-conf.d/`

    Configuration files for plugins. The file `snmp_communities` is generated by this container, but custom changes will not be overwritten.

* `/var/lib/munin/`

    All RRD files and temporary files.

* `/var/log/munin/`

    Log files.

## How to use this container

```
docker run -d \
  -v /etc/munin/munin-conf.d:/etc/munin/munin-conf.d \
  -v /etc/munin/plugin-conf.d:/etc/munin/plugin-conf.d \
  -v /var/lib/munin:/var/lib/munin \
  -v /var/log/munin:/var/log/munin \
  -e NODES="server1:10.0.0.2 server2:10.1.0.2" \
  -e SNMP_NODES="routers;10.0.0.1:mycommunity routers;10.1.0.1:mycommunity" \
  -p 80:80 \
  --name munin-server \
  kdcio/munin-server
```

Using docker-compose.yml

```
version: '2.4'

services:
  munin:
    image: kdcio/munin-server
    volumes:
      - /etc/munin/munin/munin-conf.d:/etc/munin/munin-conf.d 
      - /etc/munin/munin/plugin-conf.d:/etc/munin/plugin-conf.d
      - /var/lib/munin:/var/lib/munin 
      - /var/log/munin:/var/log/munin
    environment: 
      NODES: routers;10.0.0.1:mycommunity routers;10.1.0.1:mycommunity
    ports:
      - 80:80
```

Access container at `http://host/munin/`


